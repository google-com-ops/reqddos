<!DOCTYPE html>
<html>
<head>
  <title>Live Stats</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body style="background:#0f172a;color:white;text-align:center;">

<h1>Live Stats Request</h1>
<canvas id="chart"></canvas>

<script>
const ctx = document.getElementById("chart").getContext("2d");

const data = {
  labels: [],
  datasets: [{
    label: "Requests",
    data: [],
    borderColor: "cyan",
    tension: 0.4
  }]
};

const chart = new Chart(ctx, { type: "line", data });

async function updateChart() {
  const res = await fetch("/api/stats");
  const json = await res.json();

  const time = new Date().toLocaleTimeString();

  data.labels.push(time);
  data.datasets[0].data.push(json.total_requests);

  if (data.labels.length > 15) {
    data.labels.shift();
    data.datasets[0].data.shift();
  }

  chart.update();
}

setInterval(updateChart, 3000);
</script>

</body>
</html>
